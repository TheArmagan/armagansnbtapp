<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-QMYG5M88NQ"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-QMYG5M88NQ");
    </script>
    <link
      rel="stylesheet"
      href="https://cdn.materialdesignicons.com/5.3.45/css/materialdesignicons.min.css"
    />
    <link rel="stylesheet" href="./lib/buefy/buefy.min.css" />
    <title>Armagan's NBT App</title>
    <link rel="stylesheet" href="style.css" />
    <script>
      const { ipcRenderer } = require("electron");
    </script>
  </head>

  <body>
    <div id="app">
      <div class="control-bar">
        <div class="control-bar-text">{{title}}</div>
        <div class="control-bar-button" @click="quit">
          <b-icon icon="close"></b-icon>
        </div>
      </div>
      <main class="container" style="position: relative">
        <b-tabs position="is-centered">
          <b-tab-item label="PAG" icon="grain">
            <div class="content">
              <h1 class="subtitle">Pixel Art Generator</h1>

              <div class="columns">
                <div class="column is-half">
                  <b-field
                    class="file is-primary"
                    :class="{'has-name': !!pag.file}"
                  >
                    <b-upload v-model="pag.file" class="file-label">
                      <span class="file-cta">
                        <b-icon
                          class="file-icon"
                          :icon="pag.file ? 'file-check' : 'upload'"
                        ></b-icon>
                        <span class="file-label"
                          >{{pag.file ? "Selected" : "Select File"}}</span
                        >
                      </span>
                      <span class="file-name" v-if="pag.file">
                        {{ pag.file.name }}
                      </span>
                    </b-upload>
                  </b-field>
                </div>
                <div class="column is-half">
                  <b-field
                    class="file is-primary"
                    :class="{'has-name': !!pag.output}"
                  >
                    <b-upload v-model="pag.output" class="file-label">
                      <span class="file-cta">
                        <b-icon
                          class="file-icon"
                          :icon="pag.output ? 'file-check' : 'upload'"
                        ></b-icon>
                        <span class="file-label"
                          >{{pag.output ? "Selected" : "Select Output"}}</span
                        >
                      </span>
                      <span class="file-name" v-if="pag.output">
                        {{ pag.output.name }}
                      </span>
                    </b-upload>
                  </b-field>
                </div>
              </div>
              <div class="columns">
                <div class="column is-half">
                  <b-field label="Dithering" label-position="on-border">
                    <b-select v-model="pag.ditherFactor" expanded>
                      <option value="0">Don't dither</option>
                      <option value="AUTO" disabled>AUTO</option>
                      <option value="1">Dither every 1 pixel</option>
                      <option value="2">Dither every 2 pixel</option>
                      <option value="3">Dither every 3 pixel</option>
                      <option value="4">Dither every 4 pixel</option>
                      <option value="5" selected>Dither every 5 pixel</option>
                      <option value="6">Dither every 6 pixel</option>
                      <option value="7">Dither every 7 pixel</option>
                      <option value="8">Dither every 8 pixel</option>
                      <option value="9">Dither every 9 pixel</option>
                      <option value="10">Dither every 10 pixel</option>
                    </b-select>
                  </b-field>
                </div>
                <div class="column is-half">
                  <b-field
                    :label="`Scale Factor${pag.imageInfo ? ` (${Math.round(pag.scaleFactor*pag.imageInfo?.width)}x${Math.round(pag.scaleFactor*pag.imageInfo?.height)})` : ''}${pag.scaleFactor == 1 ? ' (Default)' : ''}`"
                    label-position="on-border"
                  >
                    <b-numberinput
                      v-model="pag.scaleFactor"
                      min="0.05"
                      max="2"
                      step="0.05"
                    ></b-numberinput>
                  </b-field>
                </div>
              </div>
              <div class="columns">
                <div class="column is-half">
                  <b-field
                    label="Align"
                    label-position="on-border"
                    style="width: 100%"
                  >
                    <b-select v-model="pag.align" expanded>
                      <option value="horizontal" selected>Horizontal</option>
                      <option value="vertical" disabled>Vertical (Soon)</option>
                    </b-select>
                  </b-field>
                </div>
              </div>
            </div>
            <div
              class="start-buttons"
              :class="{'disabled': !isPAGReadyToStart}"
            >
              <b-progress
                :value="pag.state.current"
                show-value
                :max="pag.state.max"
                type="is-info"
              >
                <span style="color: black"
                  >{{pag.state.current}}/{{pag.state.max}}</span
                ></b-progress
              >
              <div class="columns">
                <div class="column">
                  <b-button
                    type="is-primary"
                    style="width: 100%"
                    :loading="pag.state.running"
                    @click="pagStart"
                    >Generate</b-button
                  >
                </div>
                <div class="column is-two-fifths">
                  <b-button type="is-primary is-static" style="width: 100%"
                    >{{pag.state.state}}</b-button
                  >
                </div>
              </div>
            </div>
            <div class="image-info" v-if="pag.imageInfo">
              <p>{{pag.imageInfo?.width * pag.imageInfo?.height}} blocks</p>
              <p>{{pag.imageInfo?.width}}x{{pag.imageInfo?.height}}</p>
              <p>{{Math.ceil(pag.imageInfo?.size / 1024)}}KB</p>
            </div>
          </b-tab-item>
          <b-tab-item label="SMB" icon="image-filter-hdr">
            <div class="content">
              <h1 class="subtitle">Schematic Generator</h1>

              <div class="columns">
                <div class="column is-half">
                  <b-field
                    class="file is-primary"
                    :class="{'has-name': !!smb.file}"
                  >
                    <b-upload v-model="smb.file" class="file-label">
                      <span class="file-cta">
                        <b-icon
                          class="file-icon"
                          :icon="smb.file ? 'file-check' : 'upload'"
                        ></b-icon>
                        <span class="file-label"
                          >{{smb.file ? "Selected" : "Select File"}}</span
                        >
                      </span>
                      <span class="file-name" v-if="smb.file">
                        {{ smb.file.name }}
                      </span>
                    </b-upload>
                  </b-field>
                </div>
                <div class="column is-half">
                  <b-field
                    class="file is-primary"
                    :class="{'has-name': !!smb.output}"
                  >
                    <b-upload v-model="smb.output" class="file-label">
                      <span class="file-cta">
                        <b-icon
                          class="file-icon"
                          :icon="smb.output ? 'file-check' : 'upload'"
                        ></b-icon>
                        <span class="file-label"
                          >{{smb.output ? "Selected" : "Select Output"}}</span
                        >
                      </span>
                      <span class="file-name" v-if="smb.output">
                        {{ smb.output.name }}
                      </span>
                    </b-upload>
                  </b-field>
                </div>
              </div>
              <div class="columns">
                <div class="column">
                  <b-field>
                    <b-switch v-model="smb.includeAir">
                      Should Include Air Blocks?
                    </b-switch>
                  </b-field>
                </div>
              </div>
            </div>
          </b-tab-item>
          <b-tab-item label="SBE" icon="square-edit-outline">
            <div class="content">
              <h1 class="subtitle">Sulker Box Editor</h1>
            </div>
          </b-tab-item>
          <b-tab-item label="Settings" icon="cog">
            <div class="content">
              <h1 class="subtitle">Settings</h1>

              <b-collapse
                class="card"
                animation="slide"
                :open="settings.collapseIndex == 'pag'"
                @open="settings.collapseIndex = 'pag'"
              >
                <div
                  slot="trigger"
                  slot-scope="props"
                  class="card-header"
                  role="button"
                >
                  <h3 class="card-header-title">Pixel Art Generator</h3>
                  <a class="card-header-icon">
                    <b-icon :icon="props.open ? 'menu-down' : 'menu-up'">
                    </b-icon>
                  </a>
                </div>
                <div class="card-content">
                  <div class="content">
                    <b-field label="Color Map">
                      <b-input
                        type="textarea"
                        minlength="0"
                        maxlength="16384"
                        placeholder="id=stone;meta=0;topColor=#ff00ff;sideColor=#ff00ff"
                        v-model="pag.colorMap.text"
                      >
                      </b-input>
                    </b-field>
                    <b-field label="Scaffold Block">
                      <b-input
                        minlength="0"
                        maxlength="128"
                        placeholder="name=stone;meta=0"
                        v-model="pag.scaffoldBlock.text"
                      >
                      </b-input>
                    </b-field>
                  </div>
                </div>
              </b-collapse>
            </div>
          </b-tab-item>
        </b-tabs>
      </main>
    </div>
    <script src="./lib/vue/vue2.js"></script>
    <script src="./lib/buefy/buefy.min.js"></script>
    <script src="./lib/lodash/lodash.min.js"></script>
    <script src="./defaults.js"></script>

    <script src="./script.js"></script>
  </body>
</html>
